<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width" />
    </head>

    <body>
        <div id="root" class="root"></div>
        <script>
            class SuffixNode {
                constructor() {
                    this.children = [];
                    this.edge = "";
                }
            }
function addWord(node, word){
     // word += "#";
     var cur = node;
                        children = cur.children;
                    for (var i = 0; i < word.length; i++) {
                        var c = word.charAt(i);
                        var add = true
                        for (var j = 0; j < i; j++) {
                            var node = children[j];
                            if(node){
                                if(node.edge[0] === c && c != '#'){
                                    var child = node;
                                    var node = new SuffixNode();
                                    node.edge = c; //新的边
                                    children[j] = node;
                                    child.edge = child.edge.slice(1) + c
                                    node.children.push(child); //新的节点
                                    add = false
                                }else{
                                    if(node.children.length >=1){
                                        addWord(node, c )
                                    }else{
                                        node.edge += c; //修改原有的边
                                    }
                                   

                                }
                            }
                           
                        }
                        if(add){
                          var node = new SuffixNode();
                          node.edge = c; //新的边
                          children.push(node); //新的节点
                        }
                    }
}
            class SuffixTree {
                constructor() {
                    this.root = new SuffixNode();
                }
                insert(word){
                   addWord(this.root, word)
                }
                
                insert2(word) {
                  
                   // word += "#";
                    var cur = this.root,
                        children = cur.children;
                    for (var i = 0; i < word.length; i++) {
                        var c = word.charAt(i);
                        var add = true
                        for (var j = 0; j < i; j++) {
                            var node = children[j];
                            if(node){
                                if(node.edge[0] === c && c != '#'){
                                    var child = node;
                                    var node = new SuffixNode();
                                    node.edge = c; //新的边
                                    children[j] = node;
                                    child.edge = child.edge.slice(1) + c
                                    node.children.push(child); //新的节点
                                    add = false
                                }else{
                                    if(node.children.length){

                                    }else{
                                        node.edge += c; //修改原有的边
                                    }
                                   

                                }
                            }
                           
                        }
                        if(add){
                          var node = new SuffixNode();
                          node.edge = c; //新的边
                          children.push(node); //新的节点
                        }
                    }
                }
            }

            var tree = new SuffixTree();
            tree.insert("abcabx");
            //abca
            //bca
            //ca
            //a 
            console.log(tree);


        </script>
    </body>
</html>

